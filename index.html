<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤§å­¦ç”Ÿæ´»åŠ©æ‰‹ - å¢å¼ºç‰ˆ(ç”¨æˆ·ç³»ç»Ÿ)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            text-align: center;
            padding: 30px 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            position: relative;
            overflow: hidden;
        }
        header::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
            transform: rotate(30deg);
        }
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            position: relative;
            z-index: 2;
        }
        .subtitle {
            font-size: 1.3rem;
            opacity: 0.9;
            position: relative;
            z-index: 2;
        }
        .user-info {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            z-index: 2;
        }
        .login-btn, .logout-btn {
            padding: 10px 20px;
            background: rgba(255,255,255,0.25);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }
        .login-btn:hover, .logout-btn:hover {
            background: rgba(255,255,255,0.35);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .username-display {
            font-weight: bold;
            background: rgba(255,255,255,0.25);
            padding: 8px 20px;
            border-radius: 30px;
            backdrop-filter: blur(5px);
        }
        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 15px;
            flex-wrap: wrap;
        }
        .tab-btn {
            padding: 15px 30px;
            background: white;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .tab-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        }
        .tab-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        .tab-btn i {
            font-size: 18px;
        }
        .content-section {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.1);
            animation: fadeIn 0.5s ease;
            min-height: 500px;
        }
        .content-section.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* è®ºå›æ ·å¼ */
        .forum-container {
            display: grid;
            gap: 25px;
        }
        .post-form {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }
        .post-form textarea {
            width: 100%;
            height: 120px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 10px;
            resize: vertical;
            font-size: 15px;
            font-family: inherit;
            transition: border-color 0.3s;
        }
        .post-form textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);
        }
        /* ç»Ÿä¸€çš„æäº¤æŒ‰é’®æ ·å¼ï¼ˆè¦†ç›–åŸæœ‰å¦™æ‹›/èµ„æºæŒ‰é’®æ ·å¼ï¼‰ */
        .post-form button, 
        .tips-add-form button, 
        .add-resource-form button {
            margin-top: 15px;
            padding: 12px 25px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        .post-form button:hover, 
        .tips-add-form button:hover, 
        .add-resource-form button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        /* ä¿®å¤åˆ é™¤æŒ‰é’®æ ·å¼ä¸è¢«è¦†ç›– */
        .tip-delete-btn, .delete-btn {
            background: none !important;
            border: none !important;
        }
        .post-item {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            border-left: 5px solid #667eea;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .post-item:hover {
            transform: translateX(5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border-left-color: #764ba2;
        }
        .post-item::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.3s ease;
        }
        .post-item:hover::before {
            transform: scaleX(1);
        }
        .post-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-weight: bold;
            color: #444;
        }
        .post-content {
            line-height: 1.7;
            margin-bottom: 20px;
            color: #555;
        }
        .post-meta {
            font-size: 13px;
            color: #777;
            display: flex;
            justify-content: space-between;
            border-top: 1px solid #eee;
            padding-top: 15px;
        }
        .post-actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        .like-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 15px;
            display: flex;
            align-items: center;
            gap: 5px;
            color: #666;
            transition: all 0.3s ease;
            padding: 5px 10px;
            border-radius: 20px;
        }
        .like-btn:hover {
            color: #ff4757;
            background: rgba(255,71,87,0.1);
        }
        .like-btn.liked {
            color: #ff4757;
        }
        .like-count {
            font-weight: bold;
            color: #ff4757;
        }
        .delete-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: #ff4757;
            font-size: 15px;
            padding: 5px 10px;
            border-radius: 20px;
            transition: all 0.3s ease;
        }
        .delete-btn:hover {
            background: rgba(255,71,87,0.1);
        }
        /* å¸–å­è¯¦æƒ…æ ·å¼ï¼ˆé€šç”¨ï¼šè®ºå›+å¦™æ‹›ï¼‰ */
        .detail-section {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }
        .back-button {
            margin-bottom: 25px;
            padding: 12px 25px;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        .back-button:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }
        .comments-section {
            margin-top: 30px;
        }
        .comment-form {
            background: #e9ecef;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
        }
        .comment-form textarea {
            width: 100%;
            height: 100px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 10px;
            resize: vertical;
            font-size: 14px;
            font-family: inherit;
        }
        .comment-item {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .comment-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-weight: bold;
            color: #444;
        }
        .comment-content {
            line-height: 1.6;
            color: #555;
        }
        /* ç”Ÿæ´»å°å¦™æ‹›æ ·å¼ */
        .tips-add-form {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #444;
        }
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 10px;
            font-size: 15px;
            font-family: inherit;
            transition: border-color 0.3s;
        }
        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);
        }
        .tips-filter {
            margin-bottom: 25px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
        }
        .tips-filter label {
            font-weight: 600;
            color: #444;
        }
        .tips-filter select {
            padding: 8px 15px;
            border: 1px solid #ddd;
            border-radius: 10px;
            font-size: 15px;
            transition: border-color 0.3s;
        }
        .tips-filter select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);
        }
        .tips-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 25px;
        }
        .tip-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            border: 1px solid #e9ecef;
            position: relative;
            overflow: hidden;
            cursor: pointer; /* æ–°å¢ï¼šæ ‡è¯†å¯ç‚¹å‡» */
        }
        .tip-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.15);
            border-color: #667eea;
        }
        .tip-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }
        .tip-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #667eea;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .tip-content-preview {
            /* æ–°å¢ï¼šé¢„è§ˆå†…å®¹ï¼Œè¶…å‡ºçœç•¥ */
            line-height: 1.7;
            color: #666;
            margin-bottom: 20px;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .tip-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
            color: #777;
            border-top: 1px solid #eee;
            padding-top: 15px;
        }
        .tip-category {
            display: inline-block;
            background: #e9ecef;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 500;
        }
        .tip-actions {
            display: flex;
            gap: 10px;
        }
        .tip-delete-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: #ff4757;
            font-size: 14px;
            padding: 5px 10px;
            border-radius: 20px;
            transition: all 0.3s ease;
        }
        .tip-delete-btn:hover {
            background: rgba(255,71,87,0.1);
        }
        /* å­¦ä¹ èµ„æºæ•´åˆæ ·å¼ */
        .resources-container {
            display: grid;
            gap: 25px;
        }
        .resource-item {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.08);
            display: flex;
            align-items: center;
            gap: 20px;
            border: 1px solid #e9ecef;
            transition: all 0.3s ease;
        }
        .resource-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border-color: #667eea;
        }
        .resource-icon {
            font-size: 32px;
            color: #667eea;
            min-width: 50px;
            text-align: center;
        }
        .resource-info {
            flex: 1;
        }
        .resource-name {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #444;
        }
        .resource-description {
            color: #666;
            margin-bottom: 15px;
            line-height: 1.6;
        }
        .resource-link {
            color: #667eea;
            text-decoration: none;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s ease;
        }
        .resource-link:hover {
            text-decoration: underline;
            color: #764ba2;
        }
        .add-resource-form {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }
        /* ç™»å½•æ¨¡æ€æ¡†æ ·å¼ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            width: 90%;
            max-width: 450px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            position: relative;
            animation: modalAppear 0.4s ease;
        }
        @keyframes modalAppear {
            from { opacity: 0; transform: translateY(-50px) scale(0.9); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            position: relative;
        }
        .modal-header h2 {
            color: #667eea;
            font-size: 24px;
        }
        .close-modal {
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: #aaa;
            transition: all 0.3s ease;
            position: absolute;
            right: 0;
            top: -5px;
        }
        .close-modal:hover {
            color: #667eea;
            transform: rotate(90deg);
        }
        .auth-tabs {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }
        .auth-tab {
            flex: 1;
            padding: 12px;
            background: #f0f0f0;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        .auth-tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 10px rgba(102, 126, 234, 0.3);
        }
        .auth-form {
            display: none;
        }
        .auth-form.active {
            display: block;
        }
        .auth-input {
            width: 100%;
            padding: 14px 15px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
            border-radius: 10px;
            font-size: 15px;
            font-family: inherit;
            transition: all 0.3s;
        }
        .auth-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);
        }
        .auth-submit {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        .auth-submit:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(102, 126, 234, 0.4);
        }
        .auth-message {
            margin-top: 15px;
            padding: 12px;
            border-radius: 10px;
            text-align: center;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .error {
            background: #ffebee;
            color: #c62828;
            border: 1px solid #ffcdd2;
        }
        .success {
            background: #e8f5e9;
            color: #2e7d32;
            border: 1px solid #c8e6c9;
        }
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
            font-weight: 500;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 1001;
            transform: translateX(200%);
            transition: transform 0.4s ease;
        }
        .notification.show {
            transform: translateX(0);
        }
        .notification.success {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
        }
        .notification.error {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .tabs {
                flex-direction: column;
                align-items: center;
            }

            .tab-btn {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }

            .user-info {
                position: static;
                justify-content: center;
                margin-bottom: 20px;
                width: 100%;
            }

            .tips-container {
                grid-template-columns: 1fr;
            }

            .resource-item {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }

            .modal-content {
                padding: 30px 20px;
            }

            h1 {
                font-size: 2.2rem;
            }

            .subtitle {
                font-size: 1.1rem;
            }

            .tips-filter {
                flex-direction: column;
                align-items: flex-start;
            }
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(102, 126, 234, 0.3);
            border-radius: 50%;
            border-top-color: #667eea;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“ å¤§å­¦ç”Ÿæ´»åŠ©æ‰‹</h1>
            <p class="subtitle">è®©å¤§å­¦ç”Ÿæ´»æ›´ç²¾å½©ï¼</p>
            <div class="user-info" id="userInfo">
                <!-- ç”¨æˆ·ä¿¡æ¯å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
            </div>
        </header>
        <div class="tabs">
            <button class="tab-btn active" data-tab="forum">
                <i>ğŸ’¬</i> è®ºå›äº¤æµ
            </button>
            <button class="tab-btn" data-tab="tips">
                <i>ğŸ’¡</i> ç”Ÿæ´»å¦™æ‹›
            </button>
            <button class="tab-btn" data-tab="resources">
                <i>ğŸ“š</i> å­¦ä¹ èµ„æº
            </button>
        </div>
        <!-- è®ºå›æ¨¡å— -->
        <div id="forum" class="content-section active">
            <div class="forum-container">
                <div class="post-form">
                    <h3>å‘å¸ƒæ–°å¸–å­</h3>
                    <textarea id="postContent" placeholder="åˆ†äº«ä½ çš„æƒ³æ³•æˆ–é—®é¢˜..."></textarea>
                    <div class="image-upload" style="margin: 15px 0;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600;">ä¸Šä¼ å›¾ç‰‡ (å¯é€‰):</label>
                        <input type="file" id="postImage" accept="image/*" style="padding: 8px; border: 1px solid #ddd; border-radius: 10px; width: 100%;">
                        <div id="imagePreview" style="margin-top: 10px; max-width: 300px;"></div>
                    </div>
                    
                    <button onclick="submitPost()">å‘å¸ƒå¸–å­</button>
                </div>

                <div id="postsList">
                    <!-- åŠ¨æ€åŠ è½½å¸–å­ -->
                </div>
            </div>
        </div>
        <!-- è®ºå›å¸–å­è¯¦æƒ…æ¨¡å— -->
        <div id="postDetail" class="content-section">
            <div class="detail-section" id="forumPostDetailContent">
                <!-- å¸–å­è¯¦æƒ…å†…å®¹å°†åŠ¨æ€åŠ è½½ -->
            </div>
            <div class="comments-section" id="forumCommentsSection">
                <!-- è¯„è®ºåŒºåŸŸ -->
            </div>
        </div>
        <!-- ç”Ÿæ´»å°å¦™æ‹›æ¨¡å—ï¼ˆåˆ—è¡¨ï¼‰ -->
        <div id="tips" class="content-section">
            <!-- æ–°å¢ï¼šæ·»åŠ ç”Ÿæ´»å¦™æ‹›çš„è¡¨å• -->
            <div class="tips-add-form">
                <h3>æ·»åŠ ç”Ÿæ´»å¦™æ‹›</h3>
                <div class="form-group">
                    <label for="tipTitle">å¦™æ‹›æ ‡é¢˜:</label>
                    <input type="text" id="tipTitle" placeholder="è¾“å…¥å¦™æ‹›æ ‡é¢˜">
                </div>
                <div class="form-group">
                    <label for="tipContent">å¦™æ‹›å†…å®¹:</label>
                    <textarea id="tipContent" placeholder="è¾“å…¥å¦™æ‹›è¯¦ç»†å†…å®¹"></textarea>
                </div>
                <div class="form-group">
                    <label for="tipCategory">åˆ†ç±»:</label>
                    <input type="text" id="tipCategory" placeholder="å¦‚ï¼šå­¦ä¹ æ–¹æ³•ã€å¥åº·ç”Ÿæ´»ã€æ ¡å›­ç”Ÿæ´»ç­‰">
                </div>
                <!-- æ–°å¢å›¾ç‰‡ä¸Šä¼ åŒºåŸŸ -->
                <div class="form-group">
                    <label for="tipImage">ä¸Šä¼ å›¾ç‰‡ (å¯é€‰):</label>
                    <input type="file" id="tipImage" accept="image/*">
                    <div id="tipImagePreview" style="margin-top: 10px; max-width: 300px;"></div>
                </div>
                <button onclick="addTip()">æ·»åŠ å¦™æ‹›</button>
            </div>

            <!-- æ–°å¢ï¼šåˆ†ç±»ç­›é€‰ -->
            <div class="tips-filter">
                <label for="categoryFilter">ç­›é€‰åˆ†ç±»:</label>
                <select id="categoryFilter" onchange="filterTips()">
                    <option value="all">å…¨éƒ¨åˆ†ç±»</option>
                    <!-- åŠ¨æ€åŠ è½½åˆ†ç±»é€‰é¡¹ -->
                </select>
            </div>

            <div class="tips-container" id="tipsContainer">
                <!-- åŠ¨æ€åŠ è½½å°å¦™æ‹› -->
            </div>
        </div>
        <!-- ç”Ÿæ´»å¦™æ‹›è¯¦æƒ…æ¨¡å—ï¼ˆæ–°å¢ï¼‰ -->
        <div id="tipDetail" class="content-section">
            <div class="detail-section" id="tipDetailContent">
                <!-- å¦™æ‹›è¯¦æƒ…å†…å®¹å°†åŠ¨æ€åŠ è½½ -->
            </div>
            <div class="comments-section" id="tipCommentsSection">
                <!-- å¦™æ‹›è¯„è®ºåŒºåŸŸ -->
            </div>
        </div>
        <!-- å­¦ä¹ èµ„æºæ•´åˆæ¨¡å— -->
        <div id="resources" class="content-section">
            <div class="add-resource-form">
                <h3>æ·»åŠ å­¦ä¹ èµ„æº</h3>
                <div class="form-group">
                    <label for="resourceName">èµ„æºåç§°:</label>
                    <input type="text" id="resourceName" placeholder="è¾“å…¥èµ„æºåç§°">
                </div>
                <div class="form-group">
                    <label for="resourceDescription">èµ„æºæè¿°:</label>
                    <textarea id="resourceDescription" placeholder="è¾“å…¥èµ„æºæè¿°"></textarea>
                </div>
                <div class="form-group">
                    <label for="resourceLink">èµ„æºé“¾æ¥:</label>
                    <input type="url" id="resourceLink" placeholder="https://example.com">
                </div>
                <div class="form-group">
                    <label for="resourceCategory">åˆ†ç±»:</label>
                    <input type="text" id="resourceCategory" placeholder="å¦‚ï¼šç¼–ç¨‹ã€æ•°å­¦ã€è‹±è¯­ç­‰">
                </div>
                <button onclick="addResource()">æ·»åŠ èµ„æº</button>
            </div>

            <div class="resources-container" id="resourcesContainer">
                <!-- åŠ¨æ€åŠ è½½èµ„æº -->
            </div>
        </div>
    </div>
    <!-- ç™»å½•æ¨¡æ€æ¡† -->
    <div id="authModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ç”¨æˆ·ç™»å½•</h2>
                <button class="close-modal" onclick="closeAuthModal()">&times;</button>
            </div>
            <div class="auth-tabs">
                <button class="auth-tab active" onclick="switchAuthTab('login')">ç™»å½•</button>
                <button class="auth-tab" onclick="switchAuthTab('register')">æ³¨å†Œ</button>
            </div>
            <div id="loginForm" class="auth-form active">
                <input type="text" id="loginUsername" class="auth-input" placeholder="ç”¨æˆ·å">
                <input type="password" id="loginPassword" class="auth-input" placeholder="å¯†ç ">
                <button class="auth-submit" onclick="loginUser()">ç™»å½•</button>
                <div id="loginMessage" class="auth-message"></div>
            </div>
            <div id="registerForm" class="auth-form">
                <input type="text" id="registerUsername" class="auth-input" placeholder="ç”¨æˆ·å">
                <input type="password" id="registerPassword" class="auth-input" placeholder="å¯†ç ">
                <input type="password" id="confirmPassword" class="auth-input" placeholder="ç¡®è®¤å¯†ç ">
                <button class="auth-submit" onclick="registerUser()">æ³¨å†Œ</button>
                <div id="registerMessage" class="auth-message"></div>
            </div>
        </div>
    </div>

    <!-- é€šçŸ¥æç¤º -->
    <div id="notification" class="notification"></div>

    <script>
        // å…¨å±€å˜é‡
        let currentUser = null; // å½“å‰ç™»å½•ç”¨æˆ·
        let posts = [];
        let tips = [
            {
                id: 1,
                title: "é«˜æ•ˆå­¦ä¹ æŠ€å·§",
                content: "ä½¿ç”¨ç•ªèŒ„å·¥ä½œæ³•ï¼Œ25åˆ†é’Ÿä¸“æ³¨å­¦ä¹ +5åˆ†é’Ÿä¼‘æ¯ï¼Œæé«˜å­¦ä¹ æ•ˆç‡ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥æ­é…æ€ç»´å¯¼å›¾æ¥æ¢³ç†çŸ¥è¯†ç‚¹ï¼Œå°†é›¶æ•£çš„çŸ¥è¯†ç³»ç»ŸåŒ–ï¼Œè®°å¿†ä¼šæ›´ç‰¢å›ºã€‚åŒæ—¶ï¼Œæ¯å¤©å­¦ä¹ ç»“æŸåèŠ±10åˆ†é’Ÿå¤ç›˜å½“å¤©çš„å†…å®¹ï¼Œèƒ½æœ‰æ•ˆå·©å›ºè®°å¿†ã€‚",
                category: "å­¦ä¹ æ–¹æ³•",
                author: "admin",
                time: new Date('2025-01-01').toLocaleString('zh-CN'),
                comments: [] // æ–°å¢ï¼šè¯„è®ºæ•°ç»„
            },
            {
                id: 2,
                title: "æ—¶é—´ç®¡ç†",
                content: "åˆ¶å®šæ¯æ—¥è®¡åˆ’æ¸…å•ï¼Œä¼˜å…ˆå¤„ç†é‡è¦ä¸”ç´§æ€¥çš„ä»»åŠ¡ã€‚å¯ä»¥ä½¿ç”¨å››è±¡é™æ³•åˆ™æ¥åˆ’åˆ†ä»»åŠ¡ï¼šé‡è¦ä¸”ç´§æ€¥ã€é‡è¦ä¸ç´§æ€¥ã€ç´§æ€¥ä¸é‡è¦ã€ä¸é‡è¦ä¸ç´§æ€¥ã€‚æŠŠä¸»è¦ç²¾åŠ›æ”¾åœ¨é‡è¦ä¸ç´§æ€¥çš„ä»»åŠ¡ä¸Šï¼Œèƒ½æœ‰æ•ˆå‡å°‘çªå‘çŠ¶å†µã€‚å¦å¤–ï¼Œè®¾ç½®ä»»åŠ¡çš„æˆªæ­¢æ—¶é—´ï¼Œé¿å…æ‹–å»¶ã€‚",
                category: "æ—¶é—´ç®¡ç†",
                author: "student1",
                time: new Date('2025-01-02').toLocaleString('zh-CN'),
                comments: []
            },
            {
                id: 3,
                title: "å¥åº·é¥®é£Ÿ",
                content: "å¤šå–æ°´ï¼Œæ¯å¤©è‡³å°‘8æ¯æ°´ï¼Œä¿æŒèº«ä½“æ°´åˆ†å¹³è¡¡ã€‚æ—©é¤è¦åƒå¥½ï¼ŒåŒ…å«è›‹ç™½è´¨ã€ç¢³æ°´å’Œç»´ç”Ÿç´ ï¼›åˆé¤è¦åƒé¥±ï¼Œæ³¨æ„è¤ç´ æ­é…ï¼›æ™šé¤è¦åƒå°‘ï¼Œé¿å…æ²¹è…»å’Œè¿‡é¥±ã€‚å¦å¤–ï¼Œå‡å°‘å¥¶èŒ¶ã€æ²¹ç‚¸é£Ÿå“çš„æ‘„å…¥ï¼Œå¤šåƒæ°´æœå’Œè”¬èœã€‚",
                category: "å¥åº·ç”Ÿæ´»",
                author: "admin",
                time: new Date('2025-01-03').toLocaleString('zh-CN'),
                comments: []
            },
            {
                id: 4,
                title: "è€ƒè¯•å‡†å¤‡",
                content: "æå‰ä¸€ä¸ªæœˆå¼€å§‹å¤ä¹ ï¼Œåˆ¶ä½œæ€ç»´å¯¼å›¾å¸®åŠ©è®°å¿†ã€‚é¦–å…ˆæ¢³ç†è€ƒè¯•å¤§çº²ï¼Œæ˜ç¡®é‡ç‚¹å†…å®¹ï¼›ç„¶ååˆ†æ¨¡å—å¤ä¹ ï¼Œæ¯ä¸ªæ¨¡å—ç»“æŸååšå¯¹åº”çš„ç»ƒä¹ é¢˜ï¼›æœ€åè¿›è¡Œæ¨¡æ‹Ÿè€ƒè¯•ï¼Œé€‚åº”è€ƒè¯•èŠ‚å¥ã€‚å¦å¤–ï¼Œå¤ä¹ æ—¶è¦æ³¨æ„åŠ³é€¸ç»“åˆï¼Œé¿å…ç†¬å¤œå¤ä¹ ã€‚",
                category: "å­¦ä¹ æ–¹æ³•",
                author: "student1",
                time: new Date('2025-01-04').toLocaleString('zh-CN'),
                comments: []
            },
            {
                id: 5,
                title: "ç¤¾äº¤æŠ€å·§",
                content: "ä¸»åŠ¨å‚ä¸ç¤¾å›¢æ´»åŠ¨ï¼Œä¸åŒå­¦å»ºç«‹è‰¯å¥½å…³ç³»ã€‚äº¤æµæ—¶è¦å­¦ä¼šå€¾å¬ï¼Œä¸è¦éšæ„æ‰“æ–­åˆ«äººï¼›å¤šèµç¾ä»–äººï¼Œå‘ç°å¯¹æ–¹çš„ä¼˜ç‚¹ï¼›é‡åˆ°åˆ†æ­§æ—¶ï¼Œä¿æŒå†·é™ï¼Œç†æ€§æ²Ÿé€šã€‚å¦å¤–ï¼Œå¯ä»¥è®°ä½åŒå­¦çš„åå­—å’Œå…´è¶£çˆ±å¥½ï¼Œèƒ½å¿«é€Ÿæ‹‰è¿‘è·ç¦»ã€‚",
                category: "æ ¡å›­ç”Ÿæ´»",
                author: "admin",
                time: new Date('2025-01-05').toLocaleString('zh-CN'),
                comments: []
            },
            {
                id: 6,
                title: "ç†è´¢è§„åˆ’",
                content: "åˆ¶å®šæœˆåº¦é¢„ç®—ï¼Œè®°å½•æ”¯å‡ºï¼ŒåŸ¹å…»ç†è´¢æ„è¯†ã€‚é¦–å…ˆåŒºåˆ†å¿…è¦æ”¯å‡ºï¼ˆå¦‚ä¼™é£Ÿè´¹ã€äº¤é€šè´¹ï¼‰å’Œéå¿…è¦æ”¯å‡ºï¼ˆå¦‚é›¶é£Ÿã€æ¸¸æˆå……å€¼ï¼‰ï¼›ç„¶åè®¾ç½®æ¯æœˆçš„å‚¨è“„ç›®æ ‡ï¼Œå¼ºåˆ¶å‚¨è“„ï¼›å¦å¤–ï¼Œå¯ä»¥å°è¯•åšä¸€äº›å…¼èŒï¼Œå¢åŠ æ”¶å…¥æ¥æºï¼Œä½†è¦æ³¨æ„ä¸è¦å½±å“å­¦ä¹ ã€‚",
                category: "ç”Ÿæ´»æŠ€èƒ½",
                author: "student1",
                time: new Date('2025-01-06').toLocaleString('zh-CN'),
                comments: []
            }
        ];
        let resources = [
            {
                name: "Courseraåœ¨çº¿è¯¾ç¨‹",
                description: "æä¾›å„ç§å…è´¹çš„åœ¨çº¿è¯¾ç¨‹ï¼Œæ¶µç›–è®¡ç®—æœºç§‘å­¦ã€å•†ä¸šç­‰å¤šä¸ªé¢†åŸŸã€‚",
                link: "https://www.coursera.org",
                category: "åœ¨çº¿æ•™è‚²"
            },
            {
                name: "MIT OpenCourseWare",
                description: "éº»çœç†å·¥å­¦é™¢å¼€æ”¾è¯¾ç¨‹ï¼Œæä¾›å¤§é‡å…è´¹çš„é«˜è´¨é‡æ•™å­¦ææ–™ã€‚",
                link: "https://ocw.mit.edu",
                category: "å­¦æœ¯èµ„æº"
            },
            {
                name: "GitHubå­¦ä¹ èµ„æº",
                description: "å¼€æºä»£ç å¹³å°ï¼Œå¯ä»¥å­¦ä¹ å„ç§ç¼–ç¨‹é¡¹ç›®å’ŒæŠ€æœ¯æ–‡æ¡£ã€‚",
                link: "https://github.com",
                category: "ç¼–ç¨‹å­¦ä¹ "
            },
            {
                name: "Khan Academy",
                description: "æä¾›å…è´¹çš„æ•°å­¦ã€ç§‘å­¦ã€ç¼–ç¨‹ç­‰æ•™è‚²èµ„æºã€‚",
                link: "https://www.khanacademy.org",
                category: "åœ¨çº¿æ•™è‚²"
            },
            {
                name: "Wikipedia",
                description: "å…¨çƒæœ€å¤§çš„å…è´¹ç™¾ç§‘å…¨ä¹¦ï¼Œå¯æŸ¥é˜…å„ç±»çŸ¥è¯†ã€‚",
                link: "https://www.wikipedia.org",
                category: "å­¦æœ¯èµ„æº"
            }
        ];
        // å½“å‰é€‰ä¸­çš„ID
        let currentForumPostId = null; // è®ºå›å¸–å­ID
        let currentTipId = null; // å¦™æ‹›ID
        // ç”¨æˆ·æ•°æ®å­˜å‚¨
        let users = JSON.parse(localStorage.getItem('universityForumUsers')) || [
            { username: "admin", password: "admin123" },
            { username: "student1", password: "pass123" }
        ];
        let imageStorage = JSON.parse(localStorage.getItem('universityForumImages')) || {};
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // ä»æœ¬åœ°å­˜å‚¨åŠ è½½æ•°æ®
            loadFromLocalStorage();

            // åˆå§‹åŒ–æ˜¾ç¤ºå†…å®¹
            renderPosts();
            renderTips();
            renderResources();
            renderCategoryFilter(); // åˆå§‹åŒ–åˆ†ç±»ç­›é€‰å™¨
            updateUserInfo();

            // ç»‘å®šæ ‡ç­¾åˆ‡æ¢äº‹ä»¶
            const tabButtons = document.querySelectorAll('.tab-btn');
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // ç§»é™¤æ‰€æœ‰æ´»åŠ¨çŠ¶æ€
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    document.querySelectorAll('.content-section').forEach(section => {
                        section.classList.remove('active');
                    });

                    // æ·»åŠ å½“å‰æ´»åŠ¨çŠ¶æ€
                    this.classList.add('active');
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(tabId).classList.add('active');
                });
            });

            // ç»‘å®šESCé”®å…³é—­æ¨¡æ€æ¡†
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeAuthModal();
                }
            });
        });

        // æœ¬åœ°å­˜å‚¨ç›¸å…³å‡½æ•°
        function saveToLocalStorage() {
            localStorage.setItem('universityForumPosts', JSON.stringify(posts));
            localStorage.setItem('universityForumTips', JSON.stringify(tips));
            localStorage.setItem('universityForumResources', JSON.stringify(resources));
            localStorage.setItem('universityForumUsers', JSON.stringify(users));
        }

        function loadFromLocalStorage() {
            const savedPosts = localStorage.getItem('universityForumPosts');
            const savedTips = localStorage.getItem('universityForumTips');
            const savedResources = localStorage.getItem('universityForumResources');
            const savedUsers = localStorage.getItem('universityForumUsers');
            // æ–°å¢ï¼šåŠ è½½ç‹¬ç«‹çš„å›¾ç‰‡å­˜å‚¨
            const savedImages = localStorage.getItem('universityForumImages');
            
            // åŠ è½½å›¾ç‰‡å­˜å‚¨
            if (savedImages) {
                try {
                    imageStorage = JSON.parse(savedImages);
                } catch (e) {
                    console.error('åŠ è½½å›¾ç‰‡æ•°æ®å¤±è´¥:', e);
                    imageStorage = {};
                }
            }

            // åŠ è½½å¸–å­
            if (savedPosts) {
                try {
                    posts = JSON.parse(savedPosts);
                    // è¿ç§»æ—§æ•°æ®ï¼šå¦‚æœpostsé‡Œæœ‰ç›´æ¥å­˜imageçš„ï¼Œç§»åˆ°imageStorage
                    posts = posts.map(post => {
                        if (post.image && typeof post.image === 'string' && post.image.startsWith('data:image/')) {
                            const imageId = `post_${post.id}`;
                            imageStorage[imageId] = post.image; // ç§»åˆ°å›¾ç‰‡å­˜å‚¨
                            return { ...post, image: imageId }; // æ›¿æ¢ä¸ºå›¾ç‰‡ID
                        }
                        return post;
                    });
                } catch (e) {
                    console.error('åŠ è½½å¸–å­æ•°æ®å¤±è´¥:', e);
                    posts = [];
                }
            }

            // åŠ è½½å¦™æ‹›
            if (savedTips) {
                try {
                    tips = JSON.parse(savedTips);
                    // è¿ç§»æ—§æ•°æ®ï¼šå¦‚æœtipsé‡Œæœ‰ç›´æ¥å­˜imageçš„ï¼Œç§»åˆ°imageStorage
                    tips = tips.map(tip => {
                        if (tip.image && typeof tip.image === 'string' && tip.image.startsWith('data:image/')) {
                            const imageId = `tip_${tip.id}`;
                            imageStorage[imageId] = tip.image; // ç§»åˆ°å›¾ç‰‡å­˜å‚¨
                            return { ...tip, image: imageId }; // æ›¿æ¢ä¸ºå›¾ç‰‡ID
                        }
                        return tip;
                    });
                } catch (e) {
                    console.error('åŠ è½½å°å¦™æ‹›æ•°æ®å¤±è´¥:', e);
                    tips = [
                        {
                            id: 1,
                            title: "é«˜æ•ˆå­¦ä¹ æŠ€å·§",
                            content: "ä½¿ç”¨ç•ªèŒ„å·¥ä½œæ³•ï¼Œ25åˆ†é’Ÿä¸“æ³¨å­¦ä¹ +5åˆ†é’Ÿä¼‘æ¯ï¼Œæé«˜å­¦ä¹ æ•ˆç‡ã€‚",
                            category: "å­¦ä¹ æ–¹æ³•",
                            author: "admin",
                            time: new Date('2025-01-01').toLocaleString('zh-CN'),
                            comments: []
                        }
                    ];
                }
            }

            // åŠ è½½èµ„æº
            if (savedResources) {
                try {
                    resources = JSON.parse(savedResources);
                } catch (e) {
                    console.error('åŠ è½½èµ„æºæ•°æ®å¤±è´¥:', e);
                    resources = [];
                }
            }

            // åŠ è½½ç”¨æˆ·
            if (savedUsers) {
                try {
                    users = JSON.parse(savedUsers);
                } catch (e) {
                    console.error('åŠ è½½ç”¨æˆ·æ•°æ®å¤±è´¥:', e);
                    users = [
                        { username: "admin", password: "admin123" },
                        { username: "student1", password: "pass123" }
                    ];
                }
            }
            
            // ä¿å­˜è¿ç§»åçš„æ•°æ®ï¼ˆç¡®ä¿æ—§æ•°æ®è¿ç§»ç”Ÿæ•ˆï¼‰
            saveImageStorage();
            saveToLocalStorage();
        }

        // æ–°å¢ï¼šä¿å­˜å›¾ç‰‡å­˜å‚¨åˆ°localStorage
        function saveImageStorage() {
            try {
                localStorage.setItem('universityForumImages', JSON.stringify(imageStorage));
            } catch (e) {
                console.error('ä¿å­˜å›¾ç‰‡æ•°æ®å¤±è´¥ï¼ˆå¯èƒ½è¶…å‡ºé…é¢ï¼‰:', e);
                showNotification('å›¾ç‰‡å­˜å‚¨å·²æ»¡ï¼Œæ— æ³•ä¿å­˜æ–°å›¾ç‰‡ï¼', 'error');
            }
        }

        // æ–°å¢ï¼šå›¾ç‰‡å‹ç¼©å‡½æ•°ï¼ˆæ ¸å¿ƒä¼˜åŒ–ï¼‰
        function compressImage(file, maxWidth = 800, quality = 0.7) {
            return new Promise((resolve, reject) => {
                if (!file.type.startsWith('image/')) {
                    reject(new Error('ä¸æ˜¯å›¾ç‰‡æ–‡ä»¶'));
                    return;
                }

                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = function (e) {
                    const img = new Image();
                    img.src = e.target.result;
                    img.onload = function () {
                        // åˆ›å»ºcanvaså‹ç¼©
                        const canvas = document.createElement('canvas');
                        let width = img.width;
                        let height = img.height;

                        // æŒ‰å®½åº¦ç­‰æ¯”ç¼©æ”¾
                        if (width > maxWidth) {
                            height = height * (maxWidth / width);
                            width = maxWidth;
                        }

                        canvas.width = width;
                        canvas.height = height;

                        // ç»˜åˆ¶å‹ç¼©åçš„å›¾ç‰‡
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0, width, height);

                        // è½¬Base64ï¼ˆæ§åˆ¶è´¨é‡ï¼‰
                        const compressedDataUrl = canvas.toDataURL(file.type, quality);
                        resolve(compressedDataUrl);
                    };
                    img.onerror = reject;
                };
                reader.onerror = reject;
            });
        }
        // ç”¨æˆ·ç³»ç»Ÿç›¸å…³å‡½æ•°
        function switchAuthTab(tab) {
            if (tab === 'login') {
                document.getElementById('loginForm').classList.add('active');
                document.getElementById('registerForm').classList.remove('active');
                document.querySelector('.auth-tab:nth-child(1)').classList.add('active');
                document.querySelector('.auth-tab:nth-child(2)').classList.remove('active');
            } else {
                document.getElementById('registerForm').classList.add('active');
                document.getElementById('loginForm').classList.remove('active');
                document.querySelector('.auth-tab:nth-child(2)').classList.add('active');
                document.querySelector('.auth-tab:nth-child(1)').classList.remove('active');
            }
        }

        function openAuthModal() {
            document.getElementById('authModal').style.display = 'flex';
            document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
        }

        function closeAuthModal() {
            document.getElementById('authModal').style.display = 'none';
            document.body.style.overflow = 'auto'; // æ¢å¤èƒŒæ™¯æ»šåŠ¨
            clearAuthMessages();
        }

        function clearAuthMessages() {
            document.getElementById('loginMessage').className = 'auth-message';
            document.getElementById('loginMessage').textContent = '';
            document.getElementById('registerMessage').className = 'auth-message';
            document.getElementById('registerMessage').textContent = '';
        }

        function loginUser() {
            const username = document.getElementById('loginUsername').value.trim();
            const password = document.getElementById('loginPassword').value.trim();

            if (!username || !password) {
                showMessage('loginMessage', 'è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ', 'error');
                return;
            }

            // æŸ¥æ‰¾ç”¨æˆ·
            const user = users.find(u => u.username === username && u.password === password);

            if (user) {
                currentUser = user;
                saveToLocalStorage();
                updateUserInfo();
                closeAuthModal();
                showNotification('ç™»å½•æˆåŠŸï¼æ¬¢è¿å›æ¥ ' + currentUser.username, 'success');
            } else {
                showMessage('loginMessage', 'ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯', 'error');
            }
        }

        function registerUser() {
            const username = document.getElementById('registerUsername').value.trim();
            const password = document.getElementById('registerPassword').value.trim();
            const confirmPassword = document.getElementById('confirmPassword').value.trim();

            if (!username || !password || !confirmPassword) {
                showMessage('registerMessage', 'è¯·å¡«å†™æ‰€æœ‰å­—æ®µ', 'error');
                return;
            }

            if (password !== confirmPassword) {
                showMessage('registerMessage', 'ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´', 'error');
                return;
            }

            // æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨
            if (users.some(u => u.username === username)) {
                showMessage('registerMessage', 'ç”¨æˆ·åå·²å­˜åœ¨', 'error');
                return;
            }

            // æ³¨å†Œæ–°ç”¨æˆ·
            users.push({ username: username, password: password });
            currentUser = { username: username, password: password };
            saveToLocalStorage();
            updateUserInfo();
            closeAuthModal();
            showNotification('æ³¨å†ŒæˆåŠŸï¼æ¬¢è¿åŠ å…¥æˆ‘ä»¬ ' + currentUser.username, 'success');
        }

        function logoutUser() {
            currentUser = null;
            updateUserInfo();
            saveToLocalStorage();
            showNotification('å·²é€€å‡ºç™»å½•', 'success');
        }

        function showMessage(elementId, message, type) {
            const element = document.getElementById(elementId);
            element.className = `auth-message ${type}`;
            element.textContent = message;

            // 3ç§’åè‡ªåŠ¨æ¸…é™¤æ¶ˆæ¯
            setTimeout(() => {
                element.className = 'auth-message';
                element.textContent = '';
            }, 3000);
        }

        function updateUserInfo() {
            const userInfoDiv = document.getElementById('userInfo');

            if (currentUser) {
                userInfoDiv.innerHTML = `
                    <span class="username-display">ğŸ‘¤ ${currentUser.username}</span>
                    <button class="logout-btn" onclick="logoutUser()">é€€å‡ºç™»å½•</button>
                `;
            } else {
                userInfoDiv.innerHTML = `
                    <button class="login-btn" onclick="openAuthModal()">ç™»å½•/æ³¨å†Œ</button>
                `;
            }
        }

        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message, type) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type} show`;

            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // è®ºå›ç›¸å…³å‡½æ•°

        // æ›¿æ¢åŸ submitPost å‡½æ•°
        // é‡æ„ï¼šå¸–å­å‘å¸ƒï¼ˆå‹ç¼©+åˆ†ç¦»å­˜å‚¨ï¼‰
        async function submitPost() {
            if (!currentUser) {
                showNotification('è¯·å…ˆç™»å½•', 'error');
                openAuthModal();
                return;
            }

            const content = document.getElementById('postContent').value.trim();
            const imageInput = document.getElementById('postImage');
            let imageId = null; // æ”¹ä¸ºå­˜å‚¨å›¾ç‰‡ID

            // å¤„ç†å›¾ç‰‡ä¸Šä¼ ï¼ˆå‹ç¼©+åˆ†ç¦»å­˜å‚¨ï¼‰
            if (imageInput.files.length > 0) {
                try {
                    const file = imageInput.files[0];
                    // å‹ç¼©å›¾ç‰‡ï¼ˆå®½åº¦800ï¼Œè´¨é‡0.7ï¼‰
                    const compressedImage = await compressImage(file, 800, 0.7);
                    const postId = Date.now(); // æå‰ç”Ÿæˆå¸–å­ID
                    imageId = `post_${postId}`; // å›¾ç‰‡IDæ ¼å¼ï¼špost_å¸–å­ID
                    imageStorage[imageId] = compressedImage; // å­˜å…¥ç‹¬ç«‹å›¾ç‰‡å­˜å‚¨
                    saveImageStorage(); // ä¿å­˜å›¾ç‰‡
                } catch (e) {
                    showNotification('å›¾ç‰‡å‹ç¼©å¤±è´¥ï¼š' + e.message, 'error');
                    imageInput.value = '';
                    return;
                }
            }

            // ä¿å­˜å¸–å­ï¼ˆåªå­˜å›¾ç‰‡IDï¼Œä¸å­˜Base64ï¼‰
            savePost(content, imageId);
        }

        // åœ¨ DOMContentLoaded ä¸­ç»‘å®šå›¾ç‰‡é¢„è§ˆäº‹ä»¶ï¼ˆæ›¿æ¢åŸä»£ç ä¸­é”™è¯¯ä½ç½®çš„ç»‘å®šï¼‰
        document.addEventListener('DOMContentLoaded', function() {
        loadFromLocalStorage();
        renderPosts();
        renderTips();
        renderResources();
        renderCategoryFilter();
        updateUserInfo();

        // ç»‘å®šå›¾ç‰‡é¢„è§ˆäº‹ä»¶ï¼ˆç§»åˆ°è¿™é‡Œï¼Œé¿å…é‡å¤ç»‘å®šï¼‰
        // å¸–å­å›¾ç‰‡é¢„è§ˆï¼ˆæ–°å¢å‹ç¼©é¢„è§ˆï¼‰
        document.getElementById('postImage').addEventListener('change', async function(e) {
            const previewContainer = document.getElementById('imagePreview');
            previewContainer.innerHTML = '';
            const file = e.target.files[0];
            if (file) {
                try {
                    if (!file.type.startsWith('image/')) {
                        showNotification('è¯·ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶', 'error');
                        this.value = '';
                        return;
                    }
                    // å‹ç¼©é¢„è§ˆï¼ˆå’Œä¸Šä¼ é€»è¾‘ä¸€è‡´ï¼‰
                    const compressedImage = await compressImage(file, 800, 0.7);
                    const img = document.createElement('img');
                    img.src = compressedImage;
                    img.style.maxWidth = '100%';
                    img.style.borderRadius = '10px';
                    img.style.boxShadow = '0 2px 8px rgba(0,0,0,0.1)';
                    previewContainer.appendChild(img);
                    // æ˜¾ç¤ºå‹ç¼©æç¤º
                    const tip = document.createElement('p');
                    tip.style.fontSize = '12px';
                    tip.style.color = '#667eea';
                    tip.style.marginTop = '8px';
                    tip.textContent = `å›¾ç‰‡å·²å‹ç¼©ï¼ˆåŸå¤§å°ï¼š${(file.size/1024).toFixed(1)}KB â†’ é¢„ä¼°ï¼š${(compressedImage.length*0.75/1024).toFixed(1)}KBï¼‰`;
                    previewContainer.appendChild(tip);
                } catch (e) {
                    showNotification('å›¾ç‰‡é¢„è§ˆå¤±è´¥ï¼š' + e.message, 'error');
                    this.value = '';
                }
            }
        });
        // ç”Ÿæ´»å¦™æ‹›å›¾ç‰‡é¢„è§ˆäº‹ä»¶
        // å¦™æ‹›å›¾ç‰‡é¢„è§ˆï¼ˆå‹ç¼©é¢„è§ˆï¼‰
        document.getElementById('tipImage').addEventListener('change', async function(e) {
            const previewContainer = document.getElementById('tipImagePreview');
            previewContainer.innerHTML = ''; // æ¸…ç©ºä¹‹å‰çš„é¢„è§ˆ
            
            const file = e.target.files[0];
            if (file) {
                try {
                    // æ£€æŸ¥æ–‡ä»¶ç±»å‹æ˜¯å¦ä¸ºå›¾ç‰‡
                    if (!file.type.startsWith('image/')) {
                        showNotification('è¯·ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶', 'error');
                        this.value = ''; // æ¸…ç©ºé€‰æ‹©
                        return;
                    }
                    
                    // å‹ç¼©é¢„è§ˆï¼ˆå’Œä¸Šä¼ é€»è¾‘ä¸€è‡´ï¼‰
                    const compressedImage = await compressImage(file, 800, 0.7);
                    const img = document.createElement('img');
                    img.src = compressedImage;
                    img.style.maxWidth = '100%';
                    img.style.borderRadius = '10px';
                    img.style.boxShadow = '0 2px 8px rgba(0,0,0,0.1)';
                    previewContainer.appendChild(img);
                    
                    // æ˜¾ç¤ºå‹ç¼©æç¤º
                    const tip = document.createElement('p');
                    tip.style.fontSize = '12px';
                    tip.style.color = '#667eea';
                    tip.style.marginTop = '8px';
                    tip.textContent = `å›¾ç‰‡å·²å‹ç¼©ï¼ˆåŸå¤§å°ï¼š${(file.size/1024).toFixed(1)}KB â†’ é¢„ä¼°ï¼š${(compressedImage.length*0.75/1024).toFixed(1)}KBï¼‰`;
                    previewContainer.appendChild(tip);
                } catch (e) {
                    showNotification('å›¾ç‰‡é¢„è§ˆå¤±è´¥ï¼š' + e.message, 'error');
                    this.value = ''; // æ¸…ç©ºé€‰æ‹©
                }
            }
        });
    }); 
        // é‡æ„ï¼šä¿å­˜å¸–å­ï¼ˆå­˜å‚¨å›¾ç‰‡IDè€ŒéBase64ï¼‰
        function savePost(content, imageId) {
            if (!content && !imageId) {
                showNotification('å¸–å­å†…å®¹ä¸èƒ½ä¸ºç©º', 'error');
                return;
            }

            const newPost = {
                id: Date.now(), // ä½¿ç”¨æ—¶é—´æˆ³ä½œä¸ºå”¯ä¸€ID
                content: content,
                image: imageId, // åªå­˜å›¾ç‰‡IDï¼ˆå¦‚post_1735689600000ï¼‰
                author: currentUser,
                time: new Date().toLocaleString('zh-CN'),
                likes: 0,
                likedBy: [],
                comments: []
            };

            posts.unshift(newPost); // æ·»åŠ åˆ°å¸–å­åˆ—è¡¨å¼€å¤´
            saveToLocalStorage(); // ä¿å­˜å¸–å­æ•°æ®ï¼ˆæ— å›¾ç‰‡ï¼‰
            renderPosts(); // é‡æ–°æ¸²æŸ“å¸–å­åˆ—è¡¨

            // æ¸…ç©ºè¡¨å•
            document.getElementById('postContent').value = '';
            document.getElementById('postImage').value = '';
            document.getElementById('imagePreview').innerHTML = '';

            showNotification('å¸–å­å‘å¸ƒæˆåŠŸ', 'success');
        }

                



        function likePost(postId) {
            if (!currentUser) {
                showNotification('è¯·å…ˆç™»å½•åå†ç‚¹èµï¼', 'error');
                openAuthModal();
                return;
            }
            const postIndex = posts.findIndex(p => p.id === postId);
            if (postIndex === -1) return;
            const post = posts[postIndex];
            const userId = currentUser.username; // ä½¿ç”¨ç”¨æˆ·åä½œä¸ºç”¨æˆ·æ ‡è¯†

            // æ£€æŸ¥æ˜¯å¦å·²ç»ç‚¹èµ
            const userLiked = post.likedBy.includes(userId);

            if (userLiked) {
                // å–æ¶ˆç‚¹èµ
                post.likes--;
                post.likedBy = post.likedBy.filter(id => id !== userId);
            } else {
                // ç‚¹èµ
                post.likes++;
                post.likedBy.push(userId);
            }

            saveToLocalStorage(); // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
            renderPosts(); // é‡æ–°æ¸²æŸ“å¸–å­åˆ—è¡¨
            showNotification(userLiked ? 'å–æ¶ˆç‚¹èµ' : 'ç‚¹èµæˆåŠŸ', 'success');
        }

        function deletePost(postId) {
            if (!currentUser) {
                showNotification('è¯·å…ˆç™»å½•ï¼', 'error');
                openAuthModal();
                return;
            }
            const postIndex = posts.findIndex(p => p.id === postId);
            if (postIndex === -1) return;
            const post = posts[postIndex];
            // å…³é”®ä¿®å¤ï¼šå– post.author.username ä¸ currentUser.username å¯¹æ¯”
            if (post.author.username !== currentUser.username) {
                showNotification('æ‚¨åªèƒ½åˆ é™¤è‡ªå·±å‘å¸ƒçš„å¸–å­ï¼', 'error');
                return;
            }
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå¸–å­å—ï¼Ÿ')) {
                // åŒæ­¥åˆ é™¤å›¾ç‰‡
                if (post.image && imageStorage[post.image]) {
                    delete imageStorage[post.image];
                    saveImageStorage(); // ä¿å­˜å›¾ç‰‡å­˜å‚¨
                }
                posts.splice(postIndex, 1);
                saveToLocalStorage();
                renderPosts();
                showNotification('å¸–å­åˆ é™¤æˆåŠŸï¼', 'success');
            }
        }

        function renderPosts() {
        const postsList = document.getElementById('postsList');
        postsList.innerHTML = '';

        if (posts.length === 0) {
            postsList.innerHTML = '<p style="text-align:center; color:#777; padding:30px;">æš‚æ— å¸–å­ï¼Œè¯·å‘å¸ƒç¬¬ä¸€ä¸ªå¸–å­å§ï¼</p>';
            return;
        }

        posts.forEach(post => {
            const postElement = document.createElement('div');
            postElement.className = 'post-item';
            postElement.setAttribute('data-id', post.id);
            // æ–°å¢å›¾ç‰‡æ¸²æŸ“é€»è¾‘
            // æ ¹æ®å›¾ç‰‡IDä»imageStorageè¯»å–å›¾ç‰‡
            const imageData = post.image ? imageStorage[post.image] : null;
            const imageHtml = imageData ? `<div style="margin:15px 0;"><img src="${imageData}" style="max-width:100%; border-radius:8px;"/></div>` : '';
            postElement.innerHTML = `
            <div class="post-header">
                <span>${post.author.username}</span> <!-- ä¿®å¤ï¼šæ˜¾ç¤º username -->
                <span>${post.time}</span>
            </div>
            <div class="post-content">${post.content}</div>
            ${imageHtml} <!-- æ¸²æŸ“å›¾ç‰‡ -->
            <div class="post-meta">
                <span>è¯„è®º: ${post.comments.length}</span>
                <span>ç‚¹èµ: ${post.likes}</span>
            </div>
            <div class="post-actions">
                <button class="like-btn ${post.likedBy.includes(currentUser?.username) ? 'liked' : ''}"
                        onclick="likePost(${post.id})">
                â¤ï¸ <span class="like-count">${post.likes}</span>
                </button>
                ${currentUser && post.author.username === currentUser.username ?
                `<button class="delete-btn" onclick="deletePost(${post.id})">ğŸ—‘ï¸ åˆ é™¤</button>` : ''}
            </div>
            `;
            postElement.addEventListener('click', (e) => {
            if (!e.target.closest('.post-actions')) {
                showForumPostDetail(post.id);
            }
            });
            postsList.appendChild(postElement);
        });
        }

        function showForumPostDetail(postId) {
        const post = posts.find(p => p.id === postId);
        if (!post) return;
        currentForumPostId = postId;

        document.getElementById('forum').classList.remove('active');
        document.getElementById('postDetail').classList.add('active');

        const imageData = post.image ? imageStorage[post.image] : null;
        const imageHtml = imageData ? `<div style="margin:15px 0;"><img src="${imageData}" style="max-width:100%; border-radius:8px;"/></div>` : '';
        const detailContent = document.getElementById('forumPostDetailContent');
        detailContent.innerHTML = `
            <button class="back-button" onclick="goBackToForum()">â† è¿”å›è®ºå›</button>
            <div class="post-header">
            <span>${post.author.username}</span> <!-- ä¿®å¤ï¼šæ˜¾ç¤º username -->
            <span>${post.time}</span>
            </div>
            <div class="post-content">${post.content}</div>
            ${imageHtml} <!-- è¯¦æƒ…é¡µæ¸²æŸ“å›¾ç‰‡ -->
            <div class="post-meta">
            <span>è¯„è®º: ${post.comments.length}</span>
            <span>ç‚¹èµ: ${post.likes}</span>
            </div>
            <div class="post-actions">
            <button class="like-btn ${post.likedBy.includes(currentUser?.username) ? 'liked' : ''}"
                    onclick="likePost(${post.id})">
                â¤ï¸ <span class="like-count">${post.likes}</span>
            </button>
            ${currentUser && post.author.username === currentUser.username ?
                `<button class="delete-btn" onclick="deletePost(${post.id})">ğŸ—‘ï¸ åˆ é™¤</button>` : ''}
            </div>
        `;
        renderForumComments(postId);
        }

        function goBackToForum() {
            document.getElementById('postDetail').classList.remove('active');
            document.getElementById('forum').classList.add('active');
        }

        function renderForumComments(postId) {
            const post = posts.find(p => p.id === postId);
            if (!post) return;
            const commentsSection = document.getElementById('forumCommentsSection');
            commentsSection.innerHTML = `
                <div class="comment-form">
                    <h4>å‘è¡¨è¯„è®º</h4>
                    <textarea id="forumCommentContent-${postId}" placeholder="å†™ä¸‹ä½ çš„è¯„è®º..."></textarea>
                    <button onclick="addForumComment(${postId})">å‘è¡¨è¯„è®º</button>
                </div>
                <h4>è¯„è®º (${post.comments.length})</h4>
            `;
            const commentsContainer = document.createElement('div');
            commentsContainer.id = 'forumCommentsContainer';

            if (post.comments.length === 0) {
                commentsContainer.innerHTML = '<p style="text-align:center; color:#777; padding:20px;">æš‚æ— è¯„è®º</p>';
            } else {
                post.comments.forEach(comment => {
                    const commentElement = document.createElement('div');
                    commentElement.className = 'comment-item';
                    commentElement.innerHTML = `
                        <div class="comment-header">
                            <span>${comment.author}</span>
                            <span>${comment.time}</span>
                        </div>
                        <div class="comment-content">${comment.content}</div>
                    `;
                    commentsContainer.appendChild(commentElement);
                });
            }
            commentsSection.appendChild(commentsContainer);
        }

        function addForumComment(postId) {
            if (!currentUser) {
                showNotification('è¯·å…ˆç™»å½•åå†è¯„è®ºï¼', 'error');
                openAuthModal();
                return;
            }
            const commentInput = document.getElementById(`forumCommentContent-${postId}`);
            const content = commentInput.value.trim();

            if (!content) {
                showNotification('è¯·è¾“å…¥è¯„è®ºå†…å®¹ï¼', 'error');
                return;
            }
            const post = posts.find(p => p.id === postId);
            if (!post) return;
            const newComment = {
                id: Date.now(),
                author: currentUser.username,
                content: content,
                time: new Date().toLocaleString('zh-CN')
            };
            post.comments.push(newComment);
            saveToLocalStorage(); // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨

            // æ›´æ–°æ˜¾ç¤º
            renderForumComments(postId);
            renderPosts(); // æ›´æ–°å¸–å­åˆ—è¡¨ä¸­çš„è¯„è®ºæ•°

            // æ¸…ç©ºè¾“å…¥æ¡†
            commentInput.value = '';
            showNotification('è¯„è®ºå‘è¡¨æˆåŠŸï¼', 'success');
        }

        // ç”Ÿæ´»å°å¦™æ‹›ç›¸å…³å‡½æ•°
        function saveTip(title, content, category, imageId) {
            const newTip = {
                id: Date.now(),
                title: title,
                content: content,
                category: category,
                author: currentUser.username, // å­˜å‚¨ç”¨æˆ·åï¼ˆç»Ÿä¸€æƒé™æ ¡éªŒï¼‰
                time: new Date().toLocaleString('zh-CN'),
                comments: [],
                image: imageId // åªå­˜å›¾ç‰‡IDï¼ˆå¦‚tip_1735689600000ï¼‰
            };

            tips.unshift(newTip);
            saveToLocalStorage();
            renderTips();
            renderCategoryFilter(); // æ›´æ–°åˆ†ç±»ç­›é€‰å™¨

            // æ¸…ç©ºè¡¨å•
            document.getElementById('tipTitle').value = '';
            document.getElementById('tipContent').value = '';
            document.getElementById('tipCategory').value = '';
            document.getElementById('tipImage').value = '';
            document.getElementById('tipImagePreview').innerHTML = '';

            showNotification('å¦™æ‹›æ·»åŠ æˆåŠŸï¼ˆå›¾ç‰‡å·²å‹ç¼©ï¼‰', 'success');
        }

        // é‡æ„ï¼šæ·»åŠ å¦™æ‹›ï¼ˆå‹ç¼©+åˆ†ç¦»å­˜å‚¨ï¼‰
        async function addTip() {
            if (!currentUser) {
                showNotification('è¯·å…ˆç™»å½•åå†æ·»åŠ å¦™æ‹›ï¼', 'error');
                openAuthModal();
                return;
            }
            const title = document.getElementById('tipTitle').value.trim();
            const content = document.getElementById('tipContent').value.trim();
            const category = document.getElementById('tipCategory').value.trim() || 'å…¶ä»–';
            const imageInput = document.getElementById('tipImage');
            let imageId = null; // æ”¹ä¸ºå­˜å‚¨å›¾ç‰‡ID

            if (!title || !content) {
                showNotification('è¯·å¡«å†™æ ‡é¢˜å’Œå†…å®¹ï¼', 'error');
                return;
            }

            // å¤„ç†å›¾ç‰‡ä¸Šä¼ ï¼ˆå‹ç¼©+åˆ†ç¦»å­˜å‚¨ï¼‰
            if (imageInput.files.length > 0) {
                try {
                    const file = imageInput.files[0];
                    // å‹ç¼©å›¾ç‰‡ï¼ˆå®½åº¦800ï¼Œè´¨é‡0.7ï¼‰
                    const compressedImage = await compressImage(file, 800, 0.7);
                    const tipId = Date.now(); // æå‰ç”Ÿæˆå¦™æ‹›ID
                    imageId = `tip_${tipId}`; // å›¾ç‰‡IDæ ¼å¼ï¼štip_å¦™æ‹›ID
                    imageStorage[imageId] = compressedImage; // å­˜å…¥ç‹¬ç«‹å›¾ç‰‡å­˜å‚¨
                    saveImageStorage(); // ä¿å­˜å›¾ç‰‡
                } catch (e) {
                    showNotification('å›¾ç‰‡å‹ç¼©å¤±è´¥ï¼š' + e.message, 'error');
                    imageInput.value = '';
                    return;
                }
            }

            // ä¿å­˜å¦™æ‹›ï¼ˆåªå­˜å›¾ç‰‡IDï¼‰
            saveTip(title, content, category, imageId);
        }

        // æ–°å¢ï¼šåˆ é™¤ç”Ÿæ´»å¦™æ‹›ï¼ˆæƒé™æ ¡éªŒï¼‰
        function deleteTip(tipId) {
            if (!currentUser) {
                showNotification('è¯·å…ˆç™»å½•ï¼', 'error');
                openAuthModal();
                return;
            }

            const tipIndex = tips.findIndex(t => t.id === tipId);
            if (tipIndex === -1) return;

            const tip = tips[tipIndex];
            if (tip.author !== currentUser.username) {
                showNotification('æ‚¨åªèƒ½åˆ é™¤è‡ªå·±å‘å¸ƒçš„å¦™æ‹›ï¼', 'error');
                return;
            }

            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå¦™æ‹›å—ï¼Ÿ')) {
                // åŒæ­¥åˆ é™¤å›¾ç‰‡
                if (tip.image && imageStorage[tip.image]) {
                    delete imageStorage[tip.image];
                    saveImageStorage(); // ä¿å­˜å›¾ç‰‡å­˜å‚¨
                }
                tips.splice(tipIndex, 1);
                saveToLocalStorage();
                renderTips();
                renderCategoryFilter(); // æ›´æ–°åˆ†ç±»ç­›é€‰å™¨
                showNotification('å¦™æ‹›åˆ é™¤æˆåŠŸï¼', 'success');
            }
        }

        // æ–°å¢ï¼šæ¸²æŸ“åˆ†ç±»ç­›é€‰å™¨
        function renderCategoryFilter() {
            const categoryFilter = document.getElementById('categoryFilter');
            // è·å–æ‰€æœ‰å”¯ä¸€åˆ†ç±»
            const categories = [...new Set(tips.map(t => t.category))];
            // ä¿ç•™é»˜è®¤é€‰é¡¹
            categoryFilter.innerHTML = '<option value="all">å…¨éƒ¨åˆ†ç±»</option>';
            // æ·»åŠ åˆ†ç±»é€‰é¡¹
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                categoryFilter.appendChild(option);
            });
        }

        // æ–°å¢ï¼šç­›é€‰ç”Ÿæ´»å¦™æ‹›
        function filterTips() {
            const selectedCategory = document.getElementById('categoryFilter').value;
            let filteredTips = tips;
            if (selectedCategory !== 'all') {
                filteredTips = tips.filter(t => t.category === selectedCategory);
            }
            renderTips(filteredTips);
        }

        // ä¼˜åŒ–ï¼šæ¸²æŸ“ç”Ÿæ´»å¦™æ‹›ï¼ˆæ”¯æŒå›¾ç‰‡é¢„è§ˆï¼‰
        function renderTips(filteredTips = tips) {
            const tipsContainer = document.getElementById('tipsContainer');
            tipsContainer.innerHTML = '';

            if (filteredTips.length === 0) {
                tipsContainer.innerHTML = '<p style="text-align:center; color:#777; padding:30px;">æš‚æ— å¦™æ‹›ï¼Œå¿«æ¥æ·»åŠ ç¬¬ä¸€ä¸ªå§ï¼</p>';
                return;
            }

            filteredTips.forEach(tip => {
                const tipElement = document.createElement('div');
                tipElement.className = 'tip-card';
                tipElement.setAttribute('data-id', tip.id);
                // æ ¹æ®å›¾ç‰‡IDè¯»å–å›¾ç‰‡
                const imageData = tip.image ? imageStorage[tip.image] : null;
                const imagePreviewHtml = imageData ? 
                    `<div style="margin:10px 0; border-radius:8px; overflow:hidden;">
                        <img src="${imageData}" style="width:100%; height:180px; object-fit:cover;">
                    </div>` : '';
                                
                tipElement.innerHTML = `
                    <div class="tip-title">ğŸ’¡ ${tip.title}</div>
                    ${imagePreviewHtml} <!-- æ˜¾ç¤ºå›¾ç‰‡é¢„è§ˆ -->
                    <div class="tip-content-preview">${tip.content}</div>
                    <div class="tip-meta">
                        <span class="tip-category">${tip.category}</span>
                        <span style="color: #777;">å‘å¸ƒè€…: ${tip.author}</span>
                    </div>
                `;
                // ç‚¹å‡»å¡ç‰‡è¿›å…¥è¯¦æƒ…é¡µ
                tipElement.addEventListener('click', () => {
                    showTipDetail(tip.id);
                });
                // åˆ é™¤æŒ‰é’®ï¼ˆåªæœ‰ä½œè€…å¯è§ï¼‰
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'tip-delete-btn';
                deleteBtn.innerHTML = 'ğŸ—‘ï¸ åˆ é™¤';
                deleteBtn.onclick = (e) => {
                    e.stopPropagation(); // é˜»æ­¢å†’æ³¡
                    deleteTip(tip.id);
                };
                if (currentUser && tip.author === currentUser.username) {
                    tipElement.querySelector('.tip-meta').appendChild(deleteBtn);
                }
                tipsContainer.appendChild(tipElement);
            });
        }

        // æ–°å¢ï¼šæ˜¾ç¤ºå¦™æ‹›è¯¦æƒ…ï¼ˆæ”¯æŒå›¾ç‰‡ï¼‰
        function showTipDetail(tipId) {
            const tip = tips.find(t => t.id === tipId);
            if (!tip) return;
            currentTipId = tipId;

            // åˆ‡æ¢åˆ°å¦™æ‹›è¯¦æƒ…é¡µé¢
            document.getElementById('tips').classList.remove('active');
            document.getElementById('tipDetail').classList.add('active');

            // æ¸²æŸ“å›¾ç‰‡ï¼ˆå®Œæ•´å°ºå¯¸ï¼‰
            const imageData = tip.image ? imageStorage[tip.image] : null;
            const imageHtml = imageData ? 
                `<div style="margin:20px 0; border-radius:10px; overflow:hidden;">
                    <img src="${imageData}" style="width:100%; max-height:500px; object-fit:contain;">
                </div>` : '';

            // æ¸²æŸ“å¦™æ‹›è¯¦æƒ…
            const detailContent = document.getElementById('tipDetailContent');
            detailContent.innerHTML = `
                <button class="back-button" onclick="goBackToTips()">â† è¿”å›å¦™æ‹›åˆ—è¡¨</button>
                <div class="post-header">
                    <span>å‘å¸ƒè€…: ${tip.author}</span>
                    <span>å‘å¸ƒæ—¶é—´: ${tip.time}</span>
                </div>
                <h2 style="margin: 20px 0; color: #667eea;">ğŸ’¡ ${tip.title}</h2>
                <div class="post-content" style="font-size: 16px; line-height: 1.8;">${tip.content}</div>
                ${imageHtml} <!-- è¯¦æƒ…é¡µæ˜¾ç¤ºå®Œæ•´å›¾ç‰‡ -->
                <div class="post-meta" style="margin-top: 20px;">
                    <span class="tip-category">${tip.category}</span>
                    <span>è¯„è®º: ${tip.comments.length}</span>
                </div>
                ${currentUser && tip.author === currentUser.username ?
                    `<button class="delete-btn" style="margin-top: 10px;" onclick="deleteTip(${tip.id}); goBackToTips()">ğŸ—‘ï¸ åˆ é™¤å¦™æ‹›</button>` : ''}
            `;
            // æ¸²æŸ“å¦™æ‹›è¯„è®º
            renderTipComments(tipId);
        }
        function goBackToTips() {
            // 1. åˆ‡æ¢æ ‡ç­¾æ˜¾ç¤ºçŠ¶æ€
            document.getElementById('tipDetail').classList.remove('active');
            document.getElementById('tips').classList.add('active');
            
            // 2. é‡æ–°æ¸²æŸ“åˆ—è¡¨ï¼ˆä¿ç•™ç”¨æˆ·çš„åˆ†ç±»ç­›é€‰ï¼‰
            const selectedCategory = document.getElementById('categoryFilter').value;
            let filteredTips = tips;
            if (selectedCategory !== 'all') {
                filteredTips = tips.filter(t => t.category === selectedCategory);
            }
            renderTips(filteredTips);
            
            // 3. æ¸…ç©ºè¯¦æƒ…é¡µå†…å®¹ï¼ˆé¿å…ç¼“å­˜ï¼‰
            document.getElementById('tipDetailContent').innerHTML = '';
            document.getElementById('tipCommentsSection').innerHTML = '';
            
            // 4. é‡ç½®å½“å‰é€‰ä¸­çš„å¦™æ‹›ID
            currentTipId = null;
        }
        // æ–°å¢ï¼šæ¸²æŸ“å¦™æ‹›è¯„è®º
        function renderTipComments(tipId) {
            const tip = tips.find(t => t.id === tipId);
            if (!tip) return;
            const commentsSection = document.getElementById('tipCommentsSection');
            commentsSection.innerHTML = `
                <div class="comment-form">
                    <h4>å‘è¡¨è¯„è®º</h4>
                    <textarea id="tipCommentContent-${tipId}" placeholder="å†™ä¸‹ä½ çš„è¯„è®º..."></textarea>
                    <button onclick="addTipComment(${tipId})">å‘è¡¨è¯„è®º</button>
                </div>
                <h4>è¯„è®º (${tip.comments.length})</h4>
            `;
            const commentsContainer = document.createElement('div');
            commentsContainer.id = 'tipCommentsContainer';

            if (tip.comments.length === 0) {
                commentsContainer.innerHTML = '<p style="text-align:center; color:#777; padding:20px;">æš‚æ— è¯„è®ºï¼Œå¿«æ¥æŠ¢æ²™å‘ï¼</p>';
            } else {
                tip.comments.forEach(comment => {
                    const commentElement = document.createElement('div');
                    commentElement.className = 'comment-item';
                    commentElement.innerHTML = `
                        <div class="comment-header">
                            <span>${comment.author}</span>
                            <span>${comment.time}</span>
                        </div>
                        <div class="comment-content">${comment.content}</div>
                    `;
                    commentsContainer.appendChild(commentElement);
                });
            }
            commentsSection.appendChild(commentsContainer);
        }

        // æ–°å¢ï¼šæ·»åŠ å¦™æ‹›è¯„è®º
        function addTipComment(tipId) {
            if (!currentUser) {
                showNotification('è¯·å…ˆç™»å½•åå†è¯„è®ºï¼', 'error');
                openAuthModal();
                return;
            }
            const commentInput = document.getElementById(`tipCommentContent-${tipId}`);
            const content = commentInput.value.trim();

            if (!content) {
                showNotification('è¯·è¾“å…¥è¯„è®ºå†…å®¹ï¼', 'error');
                return;
            }
            const tip = tips.find(t => t.id === tipId);
            if (!tip) return;
            const newComment = {
                id: Date.now(),
                author: currentUser.username,
                content: content,
                time: new Date().toLocaleString('zh-CN')
            };
            tip.comments.push(newComment);
            saveToLocalStorage(); // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨

            // æ›´æ–°æ˜¾ç¤º
            renderTipComments(tipId);
            renderTips(); // æ›´æ–°å¦™æ‹›åˆ—è¡¨ä¸­çš„è¯„è®ºæ•°

            // æ¸…ç©ºè¾“å…¥æ¡†
            commentInput.value = '';
            showNotification('è¯„è®ºå‘è¡¨æˆåŠŸï¼', 'success');
        }

        // å­¦ä¹ èµ„æºæ•´åˆç›¸å…³å‡½æ•°
        function addResource() {
            if (!currentUser) {
                showNotification('è¯·å…ˆç™»å½•åå†æ·»åŠ èµ„æºï¼', 'error');
                openAuthModal();
                return;
            }
            const name = document.getElementById('resourceName').value.trim();
            const description = document.getElementById('resourceDescription').value.trim();
            const link = document.getElementById('resourceLink').value.trim();
            const category = document.getElementById('resourceCategory').value.trim();
            if (!name || !description || !link) {
                showNotification('è¯·å¡«å†™å®Œæ•´ä¿¡æ¯ï¼', 'error');
                return;
            }
            const newResource = {
                name: name,
                description: description,
                link: link,
                category: category || 'å…¶ä»–'
            };
            resources.unshift(newResource);
            saveToLocalStorage(); // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨

            // æ¸…ç©ºè¡¨å•
            document.getElementById('resourceName').value = '';
            document.getElementById('resourceDescription').value = '';
            document.getElementById('resourceLink').value = '';
            document.getElementById('resourceCategory').value = '';

            renderResources();
            showNotification('èµ„æºæ·»åŠ æˆåŠŸï¼', 'success');
        }

        function renderResources() {
            const resourcesContainer = document.getElementById('resourcesContainer');
            resourcesContainer.innerHTML = '';

            if (resources.length === 0) {
                resourcesContainer.innerHTML = '<p style="text-align:center; color:#777; padding:30px;">æš‚æ— èµ„æº</p>';
                return;
            }

            resources.forEach(resource => {
                const resourceElement = document.createElement('div');
                resourceElement.className = 'resource-item';
                resourceElement.innerHTML = `
                    <div class="resource-icon">ğŸ“š</div>
                    <div class="resource-info">
                        <div class="resource-name">${resource.name}</div>
                        <div class="resource-description">${resource.description}</div>
                        <a href="${resource.link}" target="_blank" class="resource-link">è®¿é—®èµ„æº â†’</a>
                    </div>
                    <div class="resource-category">${resource.category}</div>
                `;
                resourcesContainer.appendChild(resourceElement);
            });
        }
    </script>
</body>
</html>